<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
      <ion-title>Inventario</ion-title>
      <ion-button (click)="openSortMenu($event)">
        <ion-icon name="funnel" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Sección de alertas -->
  <div *ngIf="expiredItems.length > 0 || expiringSoonItems.length > 0">
    <!-- Alertas de productos vencidos -->
    <ion-card *ngIf="expiredItems.length > 0" color="danger">
      <ion-card-header>
        <ion-card-title>Productos Vencidos</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let item of expiredItems">
            <ion-label>
              <h3>{{ item.nombre }}</h3>
              <p>Venció el: {{ item.fechaVencimiento }}</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Alertas de productos por vencer -->
    <ion-card *ngIf="expiringSoonItems.length > 0" color="warning">
      <ion-card-header>
        <ion-card-title>Productos por Vencer</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let item of expiringSoonItems">
            <ion-label>
              <h3>{{ item.nombre }}</h3>
              <p>Vence el: {{ item.fechaVencimiento }}</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Lista de ítems del inventario -->
  <ion-list>
    <ion-item *ngFor="let item of sortedInventory">
      <ion-label>
        <h2>{{ item.nombre }}</h2>
        <p>Cantidad: {{ item.cantidad }} {{ item.unidadMedida }}</p>
        <p>Fecha de Vencimiento: {{ item.fechaVencimiento }}</p>
      </ion-label>
      <ion-button (click)="startEditItem(item)">Editar</ion-button>
      <ion-button color="danger" (click)="deleteItem(item.id)">Eliminar</ion-button>
    </ion-item>
  </ion-list>

  <!-- Modal para editar la cantidad -->
  <ion-modal [isOpen]="isEditModalOpen">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Editar Cantidad</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeEditModal()">Cerrar</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <ion-item>
          <ion-label position="floating">Nueva Cantidad</ion-label>
          <ion-input type="number" [(ngModel)]="editItemCantidad"></ion-input>
        </ion-item>
        <ion-button expand="full" (click)="updateItemQuantity()">Guardar Cambios</ion-button>
      </ion-content>
    </ng-template>
  </ion-modal>

  <!-- Botón para agregar un ítem -->
  <ion-button expand="full" routerLink="/add-item">Agregar Ítem</ion-button>
</ion-content> 