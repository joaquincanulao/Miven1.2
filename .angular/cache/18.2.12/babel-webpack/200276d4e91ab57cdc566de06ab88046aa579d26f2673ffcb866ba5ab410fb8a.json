{"ast":null,"code":"var _FavoritesComponent;\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/auth\";\nimport * as i2 from \"@angular/fire/compat/firestore\";\nimport * as i3 from \"../../services/recipe.service\";\nimport * as i4 from \"../../services/inventory.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@ionic/angular\";\nimport * as i8 from \"@angular/forms\";\nfunction FavoritesComponent_ion_card_21_ion_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-img\", 13);\n  }\n  if (rf & 2) {\n    const recipe_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", recipe_r2.imageUrl);\n  }\n}\nfunction FavoritesComponent_ion_card_21_ion_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 14);\n    i0.ɵɵlistener(\"click\", function FavoritesComponent_ion_card_21_ion_button_12_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const recipe_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.editRecipe(recipe_r2.id));\n    });\n    i0.ɵɵtext(1, \" Editar \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction FavoritesComponent_ion_card_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-card\");\n    i0.ɵɵtemplate(1, FavoritesComponent_ion_card_21_ion_img_1_Template, 1, 1, \"ion-img\", 8);\n    i0.ɵɵelementStart(2, \"ion-card-header\")(3, \"ion-card-title\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-card-content\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"slice\");\n    i0.ɵɵelementStart(8, \"ion-button\", 9);\n    i0.ɵɵlistener(\"click\", function FavoritesComponent_ion_card_21_Template_ion_button_click_8_listener() {\n      const recipe_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.openRecipeModal(recipe_r2));\n    });\n    i0.ɵɵtext(9, \"Ver m\\u00E1s\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"ion-button\", 10);\n    i0.ɵɵlistener(\"click\", function FavoritesComponent_ion_card_21_Template_ion_button_click_10_listener() {\n      const recipe_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.removeFromFavorites(recipe_r2.id));\n    });\n    i0.ɵɵelement(11, \"ion-icon\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, FavoritesComponent_ion_card_21_ion_button_12_Template, 2, 0, \"ion-button\", 12);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const recipe_r2 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", recipe_r2.imageUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(recipe_r2.titulo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind3(7, 6, recipe_r2.descripcion, 0, 100), \"... \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"name\", ctx_r2.isFavorite(recipe_r2.id) ? \"heart\" : \"heart-outline\")(\"color\", ctx_r2.isFavorite(recipe_r2.id) ? \"danger\" : \"medium\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", recipe_r2.creadorId === ctx_r2.userId);\n  }\n}\nfunction FavoritesComponent_ng_template_23_ion_img_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ion-img\", 13);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"src\", ctx_r2.selectedRecipe == null ? null : ctx_r2.selectedRecipe.imageUrl);\n  }\n}\nfunction FavoritesComponent_ng_template_23_ion_item_14_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 19);\n    i0.ɵɵtext(1, \"Disponible\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction FavoritesComponent_ng_template_23_ion_item_14_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 20);\n    i0.ɵɵtext(1, \"No disponible\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction FavoritesComponent_ng_template_23_ion_item_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵtemplate(3, FavoritesComponent_ng_template_23_ion_item_14_span_3_Template, 2, 0, \"span\", 17)(4, FavoritesComponent_ng_template_23_ion_item_14_span_4_Template, 2, 0, \"span\", 18);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ing_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\" \", ing_r6.nombre, \" - \", ing_r6.cantidad, \" \", ing_r6.unidad, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ing_r6.disponible);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ing_r6.disponible);\n  }\n}\nfunction FavoritesComponent_ng_template_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-buttons\", 15)(5, \"ion-button\", 16);\n    i0.ɵɵlistener(\"click\", function FavoritesComponent_ng_template_23_Template_ion_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.closeModal());\n    });\n    i0.ɵɵtext(6, \"Cerrar\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(7, \"ion-content\");\n    i0.ɵɵtemplate(8, FavoritesComponent_ng_template_23_ion_img_8_Template, 1, 1, \"ion-img\", 8);\n    i0.ɵɵelementStart(9, \"ion-list\")(10, \"ion-item\")(11, \"ion-label\")(12, \"h2\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(14, FavoritesComponent_ng_template_23_ion_item_14_Template, 5, 5, \"ion-item\", 6);\n    i0.ɵɵelementStart(15, \"ion-item\")(16, \"ion-label\")(17, \"h2\");\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(19, \"ion-button\", 16);\n    i0.ɵɵlistener(\"click\", function FavoritesComponent_ng_template_23_Template_ion_button_click_19_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.closeModal());\n    });\n    i0.ɵɵtext(20, \"Cerrar\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r2.selectedRecipe == null ? null : ctx_r2.selectedRecipe.titulo);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.selectedRecipe == null ? null : ctx_r2.selectedRecipe.imageUrl);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.selectedRecipe == null ? null : ctx_r2.selectedRecipe.titulo);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.availableIngredients);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r2.selectedRecipe == null ? null : ctx_r2.selectedRecipe.descripcion);\n  }\n}\nexport class FavoritesComponent {\n  constructor(auth, firestore, recipeService, inventoryService, router) {\n    this.auth = auth;\n    this.firestore = firestore;\n    this.recipeService = recipeService;\n    this.inventoryService = inventoryService;\n    this.router = router;\n    this.userId = null;\n    this.favorites = []; // Aquí se almacenan todas las recetas favoritas\n    this.filteredFavorites = []; // Recetas filtradas por categoría\n    this.isModalOpen = false;\n    this.selectedRecipe = null;\n    this.selectedCategory = 'desayuno'; // Categoría seleccionada por defecto\n    this.isAuthenticated = false;\n    this.availableIngredients = [];\n    console.log('en construct');\n  }\n  ngOnInit() {\n    this.auth.authState.subscribe(user => {\n      this.isAuthenticated = !!user;\n      console.log('isAuthenticated subscribe :: ', this.isAuthenticated);\n      if (this.isAuthenticated) {\n        if (user && user.uid) {\n          this.userId = user.uid;\n          this.filterFavorites();\n        }\n      }\n    });\n  }\n  // Método para filtrar las recetas según la categoría seleccionada\n  filterFavorites() {\n    console.log('this === ', this.userId);\n    if (this.userId) {\n      this.filteredFavorites = [];\n      const favoritos = this.firestore.collection('usuarios').doc(this.userId).collection('favoritos', ref => ref.where('category', '==', this.selectedCategory)).get().forEach(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          const datos = doc.data();\n          // Verifica si 'recipeId' existe en el documento\n          if (datos['recipeId']) {\n            console.log('Procesando receta con ID:', datos['recipeId']);\n            this.firestore.collection('recetas').doc(datos['recipeId']).get().forEach(rec => {\n              if (rec.exists) {\n                const d = rec.data();\n                d.id = doc.id; // ID del favorito\n                d.creadorId = datos['creadorId'] || null; // Si existe el creadorId\n                this.filteredFavorites.push(d);\n              } else {\n                console.warn(`La receta con ID ${datos['recipeId']} no existe.`);\n              }\n            });\n          } else {\n            console.warn(`El documento favorito con ID ${doc.id} no tiene un campo 'recipeId'.`);\n          }\n        });\n      });\n    }\n  }\n  openRecipeModal(recipe) {\n    this.selectedRecipe = recipe;\n    this.checkIngredientsAvailability(recipe.ingredientes);\n    this.recipeService.getRecipeCommentsWithUser(recipe.id).subscribe(comments => {\n      this.selectedRecipe.comentarios = comments;\n    });\n    this.isModalOpen = true;\n  }\n  // Método para cerrar el modal\n  closeModal() {\n    this.isModalOpen = false;\n    this.selectedRecipe = null;\n  }\n  removeFromFavorites(recipeId) {\n    console.log('recipeId :: ', recipeId);\n    if (this.userId) {\n      this.firestore.collection('usuarios').doc(this.userId).collection('favoritos').doc(recipeId).delete();\n      this.filterFavorites();\n    }\n  }\n  checkIngredientsAvailability(recipeIngredients) {\n    if (this.userId) {\n      this.inventoryService.getInventory(this.userId).subscribe(inventory => {\n        this.availableIngredients = recipeIngredients.map(ingredient => {\n          const inventoryItem = inventory.find(item => {\n            var _item$nombre, _ingredient$nombre;\n            return (item === null || item === void 0 || (_item$nombre = item.nombre) === null || _item$nombre === void 0 ? void 0 : _item$nombre.toLowerCase()) === (ingredient === null || ingredient === void 0 || (_ingredient$nombre = ingredient.nombre) === null || _ingredient$nombre === void 0 ? void 0 : _ingredient$nombre.toLowerCase());\n          });\n          return {\n            nombre: ingredient.nombre,\n            cantidad: ingredient.cantidad,\n            unidad: ingredient.unidad,\n            disponible: inventoryItem ? inventoryItem.cantidad >= ingredient.cantidad : false\n          };\n        });\n      });\n    }\n  }\n  isFavorite(recipeId) {\n    return this.favorites.some(fav => fav.recipeId === recipeId);\n  }\n  // Nuevo método para editar receta\n  editRecipe(recipeId) {\n    if (this.userId) {\n      this.firestore.collection('usuarios').doc(this.userId).collection('favoritos', ref => ref.where('category', '==', this.selectedCategory)).get().forEach(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          const datos = doc.data(); // Obtener los datos correctos de cada documento\n          if (datos['recipeId']) {\n            console.log('Procesando receta con ID:', datos['recipeId']);\n            this.firestore.collection('recetas').doc(datos['recipeId']).get().subscribe(rec => {\n              if (rec.exists) {\n                const d = rec.data();\n                d.id = doc.id; // ID del favorito\n                d.creadorId = datos['creadorId'] || null;\n                this.filteredFavorites.push(d);\n              } else {\n                console.warn(`La receta con ID ${datos['recipeId']} no existe.`);\n                // Opcional: Eliminar favoritos con IDs inválidos\n                if (this.userId) {\n                  this.firestore.collection('usuarios').doc(this.userId).collection('favoritos').doc(doc.id).delete().then(() => console.log(`Documento favorito con ID ${doc.id} eliminado.`));\n                }\n              }\n            });\n          } else {\n            console.warn(`El documento favorito con ID ${doc.id} no tiene un campo 'recipeId'.`);\n          }\n        });\n      });\n    }\n  }\n}\n_FavoritesComponent = FavoritesComponent;\n_FavoritesComponent.ɵfac = function FavoritesComponent_Factory(__ngFactoryType__) {\n  return new (__ngFactoryType__ || _FavoritesComponent)(i0.ɵɵdirectiveInject(i1.AngularFireAuth), i0.ɵɵdirectiveInject(i2.AngularFirestore), i0.ɵɵdirectiveInject(i3.RecipeService), i0.ɵɵdirectiveInject(i4.InventoryService), i0.ɵɵdirectiveInject(i5.Router));\n};\n_FavoritesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _FavoritesComponent,\n  selectors: [[\"app-favorites\"]],\n  decls: 24,\n  vars: 3,\n  consts: [[\"slot\", \"start\"], [3, \"ngModelChange\", \"ionChange\", \"ngModel\"], [\"value\", \"desayuno\"], [\"value\", \"almuerzo\"], [\"value\", \"cena\"], [\"value\", \"postre\"], [4, \"ngFor\", \"ngForOf\"], [3, \"didDismiss\", \"isOpen\"], [\"alt\", \"Imagen de la receta\", 3, \"src\", 4, \"ngIf\"], [\"fill\", \"clear\", 3, \"click\"], [\"fill\", \"clear\", \"color\", \"danger\", 3, \"click\"], [3, \"name\", \"color\"], [\"fill\", \"clear\", \"color\", \"primary\", 3, \"click\", 4, \"ngIf\"], [\"alt\", \"Imagen de la receta\", 3, \"src\"], [\"fill\", \"clear\", \"color\", \"primary\", 3, \"click\"], [\"slot\", \"end\"], [3, \"click\"], [\"style\", \"color: green;\", 4, \"ngIf\"], [\"style\", \"color: red;\", 4, \"ngIf\"], [2, \"color\", \"green\"], [2, \"color\", \"red\"]],\n  template: function FavoritesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-buttons\", 0);\n      i0.ɵɵelement(2, \"ion-menu-button\");\n      i0.ɵɵelementStart(3, \"ion-title\");\n      i0.ɵɵtext(4, \"Recetas Favoritas\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(5, \"ion-toolbar\")(6, \"ion-segment\", 1);\n      i0.ɵɵtwoWayListener(\"ngModelChange\", function FavoritesComponent_Template_ion_segment_ngModelChange_6_listener($event) {\n        i0.ɵɵtwoWayBindingSet(ctx.selectedCategory, $event) || (ctx.selectedCategory = $event);\n        return $event;\n      });\n      i0.ɵɵlistener(\"ionChange\", function FavoritesComponent_Template_ion_segment_ionChange_6_listener() {\n        return ctx.filterFavorites();\n      });\n      i0.ɵɵelementStart(7, \"ion-segment-button\", 2)(8, \"ion-label\");\n      i0.ɵɵtext(9, \"Desayuno\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"ion-segment-button\", 3)(11, \"ion-label\");\n      i0.ɵɵtext(12, \"Almuerzo\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"ion-segment-button\", 4)(14, \"ion-label\");\n      i0.ɵɵtext(15, \"Cena\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(16, \"ion-segment-button\", 5)(17, \"ion-label\");\n      i0.ɵɵtext(18, \"Postre\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(19, \"ion-content\")(20, \"ion-list\");\n      i0.ɵɵtemplate(21, FavoritesComponent_ion_card_21_Template, 13, 10, \"ion-card\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"ion-modal\", 7);\n      i0.ɵɵlistener(\"didDismiss\", function FavoritesComponent_Template_ion_modal_didDismiss_22_listener() {\n        return ctx.closeModal();\n      });\n      i0.ɵɵtemplate(23, FavoritesComponent_ng_template_23_Template, 21, 5, \"ng-template\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedCategory);\n      i0.ɵɵadvance(15);\n      i0.ɵɵproperty(\"ngForOf\", ctx.filteredFavorites);\n      i0.ɵɵadvance();\n      i0.ɵɵproperty(\"isOpen\", ctx.isModalOpen);\n    }\n  },\n  dependencies: [i6.NgForOf, i6.NgIf, i7.IonButton, i7.IonButtons, i7.IonCard, i7.IonCardContent, i7.IonCardHeader, i7.IonCardTitle, i7.IonContent, i7.IonHeader, i7.IonIcon, i7.IonImg, i7.IonItem, i7.IonLabel, i7.IonList, i7.IonMenuButton, i7.IonSegment, i7.IonSegmentButton, i7.IonTitle, i7.IonToolbar, i7.IonModal, i7.SelectValueAccessor, i8.NgControlStatus, i8.NgModel, i6.SlicePipe],\n  styles: [\".delete-button[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 5px;\\n  right: 5px;\\n  background: none;\\n  border: none;\\n  color: red;\\n  font-size: 10px;\\n  cursor: pointer;\\n  padding: 0;\\n  \\n\\n}\\n.delete-button[_ngcontent-%COMP%]:hover {\\n  color: darkred;\\n  transform: scale(1);\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9mYXZvcml0ZXMvZmF2b3JpdGVzLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQ0ksa0JBQUE7RUFDQSxRQUFBO0VBQ0EsVUFBQTtFQUNBLGdCQUFBO0VBQ0EsWUFBQTtFQUNBLFVBQUE7RUFDQSxlQUFBO0VBQ0EsZUFBQTtFQUNBLFVBQUE7RUFFRSwyREFBQTtBQUROO0FBRUU7RUFDRSxjQUFBO0VBQ0EsbUJBQUE7QUFBSiIsInNvdXJjZXNDb250ZW50IjpbIlxuLmRlbGV0ZS1idXR0b24ge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICB0b3A6IDVweDtcbiAgICByaWdodDogNXB4O1xuICAgIGJhY2tncm91bmQ6IG5vbmU7XG4gICAgYm9yZGVyOiBub25lO1xuICAgIGNvbG9yOiByZWQ7XG4gICAgZm9udC1zaXplOiAxMHB4O1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBwYWRkaW5nOiAwO1xuXG4gICAgICAvKiBPcGNpb25hbDogYWdyZWdhciB1biBob3ZlciBwYXJhIG1lam9yYXIgbGEgZXhwZXJpZW5jaWEgKi9cbiAgJjpob3ZlciB7XG4gICAgY29sb3I6IGRhcmtyZWQ7XG4gICAgdHJhbnNmb3JtOiBzY2FsZSgxKTtcbiAgfVxufSAgIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["i0","ɵɵelement","ɵɵproperty","recipe_r2","imageUrl","ɵɵelementStart","ɵɵlistener","FavoritesComponent_ion_card_21_ion_button_12_Template_ion_button_click_0_listener","ɵɵrestoreView","_r4","ɵɵnextContext","$implicit","ctx_r2","ɵɵresetView","editRecipe","id","ɵɵtext","ɵɵelementEnd","ɵɵtemplate","FavoritesComponent_ion_card_21_ion_img_1_Template","FavoritesComponent_ion_card_21_Template_ion_button_click_8_listener","_r1","openRecipeModal","FavoritesComponent_ion_card_21_Template_ion_button_click_10_listener","removeFromFavorites","FavoritesComponent_ion_card_21_ion_button_12_Template","ɵɵadvance","ɵɵtextInterpolate","titulo","ɵɵtextInterpolate1","ɵɵpipeBind3","descripcion","isFavorite","creadorId","userId","selectedRecipe","FavoritesComponent_ng_template_23_ion_item_14_span_3_Template","FavoritesComponent_ng_template_23_ion_item_14_span_4_Template","ɵɵtextInterpolate3","ing_r6","nombre","cantidad","unidad","disponible","FavoritesComponent_ng_template_23_Template_ion_button_click_5_listener","_r5","closeModal","FavoritesComponent_ng_template_23_ion_img_8_Template","FavoritesComponent_ng_template_23_ion_item_14_Template","FavoritesComponent_ng_template_23_Template_ion_button_click_19_listener","availableIngredients","FavoritesComponent","constructor","auth","firestore","recipeService","inventoryService","router","favorites","filteredFavorites","isModalOpen","selectedCategory","isAuthenticated","console","log","ngOnInit","authState","subscribe","user","uid","filterFavorites","favoritos","collection","doc","ref","where","get","forEach","querySnapshot","datos","data","rec","exists","d","push","warn","recipe","checkIngredientsAvailability","ingredientes","getRecipeCommentsWithUser","comments","comentarios","recipeId","delete","recipeIngredients","getInventory","inventory","map","ingredient","inventoryItem","find","item","_item$nombre","_ingredient$nombre","toLowerCase","some","fav","then","ɵɵdirectiveInject","i1","AngularFireAuth","i2","AngularFirestore","i3","RecipeService","i4","InventoryService","i5","Router","selectors","decls","vars","consts","template","FavoritesComponent_Template","rf","ctx","ɵɵtwoWayListener","FavoritesComponent_Template_ion_segment_ngModelChange_6_listener","$event","ɵɵtwoWayBindingSet","FavoritesComponent_Template_ion_segment_ionChange_6_listener","FavoritesComponent_ion_card_21_Template","FavoritesComponent_Template_ion_modal_didDismiss_22_listener","FavoritesComponent_ng_template_23_Template","ɵɵtwoWayProperty"],"sources":["/home/jcanulao/Documentos/Miven1.0.0-main/src/app/components/favorites/favorites.component.ts","/home/jcanulao/Documentos/Miven1.0.0-main/src/app/components/favorites/favorites.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\nimport { RecipeService } from '../../services/recipe.service';\nimport { InventoryService } from '../../services/inventory.service';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-favorites',\n  templateUrl: './favorites.component.html',\n  styleUrls: ['./favorites.component.scss'],\n})\nexport class FavoritesComponent implements OnInit {\n  userId: string | null = null;\n  favorites: any[] = []; // Aquí se almacenan todas las recetas favoritas\n  filteredFavorites: any[] = []; // Recetas filtradas por categoría\n  isModalOpen = false;\n  selectedRecipe: any | null = null;\n  selectedCategory = 'desayuno'; // Categoría seleccionada por defecto\n  isAuthenticated: boolean = false;\n  availableIngredients: any[] = [];\n\n  constructor(\n    private auth: AngularFireAuth,\n    private firestore: AngularFirestore,\n    private recipeService: RecipeService, \n    private inventoryService: InventoryService,\n    private router: Router\n  ) {\n    console.log('en construct');\n  }\n\n  ngOnInit(): void {\n    this.auth.authState.subscribe(user => {\n      this.isAuthenticated = !!user;\n      console.log('isAuthenticated subscribe :: ', this.isAuthenticated);\n      if (this.isAuthenticated) {\n        if (user && user.uid) {\n          this.userId = user.uid;\n          this.filterFavorites();\n        }\n      }\n    });\n  }\n\n  // Método para filtrar las recetas según la categoría seleccionada\n  filterFavorites() {\n    console.log('this === ', this.userId);\n\n    if (this.userId) {   \n      this.filteredFavorites = [];\n      const favoritos = this.firestore.collection('usuarios').doc(this.userId).collection('favoritos',\n        ref => ref.where('category', '==', this.selectedCategory)\n      ).get().forEach((querySnapshot) => {\n        querySnapshot.forEach((doc) => {\n          const datos = doc.data();\n      \n          // Verifica si 'recipeId' existe en el documento\n          if (datos['recipeId']) {\n            console.log('Procesando receta con ID:', datos['recipeId']);\n            \n            this.firestore.collection('recetas').doc(datos['recipeId']).get().forEach(\n              (rec) => {\n                if (rec.exists) {\n                  const d: any = rec.data();\n                  d.id = doc.id; // ID del favorito\n                  d.creadorId = datos['creadorId'] || null; // Si existe el creadorId\n                  this.filteredFavorites.push(d);\n                } else {\n                  console.warn(`La receta con ID ${datos['recipeId']} no existe.`);\n                }\n              }\n            );\n          } else {\n            console.warn(`El documento favorito con ID ${doc.id} no tiene un campo 'recipeId'.`);\n          }\n        });\n      });   \n    }\n  }\n\n  openRecipeModal(recipe: any) {\n    this.selectedRecipe = recipe;\n    this.checkIngredientsAvailability(recipe.ingredientes);\n    this.recipeService.getRecipeCommentsWithUser(recipe.id).subscribe((comments: any[]) => {\n      this.selectedRecipe.comentarios = comments;\n    });\n    this.isModalOpen = true;\n  }\n\n  // Método para cerrar el modal\n  closeModal() {\n    this.isModalOpen = false;\n    this.selectedRecipe = null;\n  }\n\n  removeFromFavorites(recipeId: string) {\n    console.log('recipeId :: ', recipeId);\n    if (this.userId) {  \n      this.firestore.collection('usuarios').doc(this.userId).collection('favoritos').doc(recipeId).delete();\n      this.filterFavorites();\n    }\n  }\n\n  checkIngredientsAvailability(recipeIngredients: { nombre: string; cantidad: number; unidad: string }[]) {\n    if (this.userId) {\n      this.inventoryService.getInventory(this.userId).subscribe(inventory => {\n        this.availableIngredients = recipeIngredients.map(ingredient => {\n          const inventoryItem = inventory.find(item => \n            item?.nombre?.toLowerCase() === ingredient?.nombre?.toLowerCase()\n          );\n          return {\n            nombre: ingredient.nombre,\n            cantidad: ingredient.cantidad,\n            unidad: ingredient.unidad,\n            disponible: inventoryItem ? inventoryItem.cantidad >= ingredient.cantidad : false\n          };\n        });\n      });\n    }\n  }\n\n  isFavorite(recipeId: string): boolean {\n    return this.favorites.some(fav => fav.recipeId === recipeId);\n  }\n\n  // Nuevo método para editar receta\n  editRecipe(recipeId: string) {\n    if (this.userId) {\n      this.firestore\n      .collection('usuarios')\n      .doc(this.userId)\n      .collection('favoritos', ref => ref.where('category', '==', this.selectedCategory))\n      .get()\n      .forEach((querySnapshot) => {\n        querySnapshot.forEach((doc) => {\n          const datos = doc.data(); // Obtener los datos correctos de cada documento\n    \n          if (datos['recipeId']) {\n            console.log('Procesando receta con ID:', datos['recipeId']);\n    \n            this.firestore.collection('recetas').doc(datos['recipeId']).get().subscribe((rec) => {\n              if (rec.exists) {\n                const d: any = rec.data();\n                d.id = doc.id; // ID del favorito\n                d.creadorId = datos['creadorId'] || null;\n                this.filteredFavorites.push(d);\n              } else {\n                console.warn(`La receta con ID ${datos['recipeId']} no existe.`);\n                // Opcional: Eliminar favoritos con IDs inválidos\n                if (this.userId) { \n                  this.firestore\n                    .collection('usuarios')\n                    .doc(this.userId)\n                    .collection('favoritos')\n                    .doc(doc.id)\n                    .delete()\n                    .then(() => console.log(`Documento favorito con ID ${doc.id} eliminado.`))\n                    ;\n              }\n            }\n            });\n          } else {\n            console.warn(`El documento favorito con ID ${doc.id} no tiene un campo 'recipeId'.`);\n          }\n        });\n      });\n    \n    }\n  }\n}\n\n","<ion-header>\n  <ion-buttons slot=\"start\">\n    <ion-menu-button></ion-menu-button>\n  <ion-title>Recetas Favoritas</ion-title>\n  </ion-buttons>\n</ion-header>\n\n<ion-toolbar>\n   \n   <ion-segment [(ngModel)]=\"selectedCategory\" (ionChange)=\"filterFavorites()\">\n     <ion-segment-button value=\"desayuno\">\n       <ion-label>Desayuno</ion-label>\n     </ion-segment-button>\n     <ion-segment-button value=\"almuerzo\">\n       <ion-label>Almuerzo</ion-label>\n     </ion-segment-button>\n     <ion-segment-button value=\"cena\">\n       <ion-label>Cena</ion-label>\n     </ion-segment-button>\n     <ion-segment-button value=\"postre\">\n       <ion-label>Postre</ion-label>\n     </ion-segment-button>\n   </ion-segment>\n \n </ion-toolbar>\n\n<!-- {{ filteredFavorites | json }} -->\n<ion-content>\n <ion-list>\n   <!-- Iterar sobre las recetas favoritas filtradas -->\n   <ion-card *ngFor=\"let recipe of filteredFavorites\">\n     <ion-img *ngIf=\"recipe.imageUrl\" [src]=\"recipe.imageUrl\" alt=\"Imagen de la receta\"></ion-img>\n\n     <ion-card-header>\n       <ion-card-title>{{ recipe.titulo }}</ion-card-title>\n     </ion-card-header>\n\n     <ion-card-content>\n       <!-- {{ recipe  | json}} -->\n       <!-- Mostrar una descripcion corta -->\n       {{ recipe.descripcion | slice: 0:100 }}...\n\n       <!-- Botones para ver mas y eliminar de favoritos -->\n       <ion-button fill=\"clear\" (click)=\"openRecipeModal(recipe)\">Ver más</ion-button>\n       <ion-button fill=\"clear\" color=\"danger\" (click)=\"removeFromFavorites(recipe.id)\">\n         <ion-icon \n         [name]=\"isFavorite(recipe.id) ? 'heart' : 'heart-outline'\" \n         [color]=\"isFavorite(recipe.id) ? 'danger' : 'medium'\">\n       </ion-icon>\n     </ion-button>\n       <ion-button fill=\"clear\" color=\"primary\" *ngIf=\"recipe.creadorId === userId\" (click)=\"editRecipe(recipe.id)\">\n         Editar\n       </ion-button>\n     </ion-card-content>\n   </ion-card>\n </ion-list>\n\n <!-- Modal de detalles de la receta -->\n <ion-modal [isOpen]=\"isModalOpen\" (didDismiss)=\"closeModal()\">\n   <ng-template>\n     <ion-header>\n       <ion-toolbar>\n         <ion-title>{{ selectedRecipe?.titulo }}</ion-title>\n         <ion-buttons slot=\"end\">\n           <ion-button (click)=\"closeModal()\">Cerrar</ion-button>\n         </ion-buttons>\n       </ion-toolbar>\n     </ion-header>\n\n     <ion-content>\n       <ion-img *ngIf=\"selectedRecipe?.imageUrl\" [src]=\"selectedRecipe?.imageUrl\" alt=\"Imagen de la receta\"></ion-img>\n\n       <ion-list>\n         <ion-item>\n           <ion-label>\n             <h2>{{ selectedRecipe?.titulo }}</h2>\n           </ion-label>\n         </ion-item>\n\n         <!-- Descripción completa -->\n\n         <ion-item *ngFor=\"let ing of availableIngredients\">\n           <ion-label>\n             {{ ing.nombre }} - {{ ing.cantidad }} {{ ing.unidad }}\n             <span *ngIf=\"ing.disponible\" style=\"color: green;\">Disponible</span>\n             <span *ngIf=\"!ing.disponible\" style=\"color: red;\">No disponible</span>\n           </ion-label>\n         </ion-item>\n\n   <ion-item>\n        <ion-label>\n         <h2>{{ selectedRecipe?.descripcion }}</h2>\n       </ion-label>\n     </ion-item>\n   </ion-list>\n\n       <ion-button (click)=\"closeModal()\">Cerrar</ion-button>\n     </ion-content>\n   </ng-template>\n </ion-modal>\n</ion-content>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}