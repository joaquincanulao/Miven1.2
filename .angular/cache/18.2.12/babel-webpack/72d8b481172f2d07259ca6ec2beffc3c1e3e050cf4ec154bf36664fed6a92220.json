{"ast":null,"code":"import { finalize } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/recipe.service\";\nimport * as i2 from \"../../services/inventory.service\";\nimport * as i3 from \"@angular/fire/compat/auth\";\nimport * as i4 from \"@angular/fire/compat/storage\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@ionic/angular\";\nimport * as i7 from \"@angular/forms\";\nfunction AddRecipeComponent_ion_item_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\");\n    i0.ɵɵelement(1, \"img\", 17);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"src\", ctx_r0.imagePreview, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction AddRecipeComponent_ion_select_option_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", item_r2.nombre);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(item_r2.nombre);\n  }\n}\nfunction AddRecipeComponent_ion_item_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ing_r3 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate3(\" \", ing_r3.nombre, \" - \", ing_r3.cantidad, \" \", ing_r3.unidad, \" \");\n  }\n}\nexport let AddRecipeComponent = /*#__PURE__*/(() => {\n  var _AddRecipeComponent;\n  class AddRecipeComponent {\n    constructor(recipeService, inventoryService, auth, storage) {\n      this.recipeService = recipeService;\n      this.inventoryService = inventoryService;\n      this.auth = auth;\n      this.storage = storage;\n      this.titulo = '';\n      this.imageUrl = null;\n      this.descripcion = '';\n      this.categoria = 'desayuno';\n      this.ingredientes = []; // Cambiado de string[] a Ingredient[]\n      this.ingrediente = '';\n      this.cantidadIngrediente = 1;\n      this.unidadIngrediente = 'unidad'; // Nueva propiedad\n      this.selectedFile = null;\n      this.imagePreview = null;\n      this.globalItems = [];\n    }\n    ngOnInit() {\n      this.loadGlobalItems();\n    }\n    loadGlobalItems() {\n      this.inventoryService.getGlobalItems().subscribe(items => {\n        this.globalItems = items;\n      });\n    }\n    addIngredient() {\n      if (this.ingrediente.trim()) {\n        const nuevoIngrediente = {\n          nombre: this.ingrediente.trim(),\n          cantidad: this.cantidadIngrediente,\n          unidad: this.unidadIngrediente\n        };\n        this.ingredientes.push(nuevoIngrediente);\n        this.ingrediente = '';\n        this.cantidadIngrediente = 1;\n        this.unidadIngrediente = 'unidad';\n      }\n    }\n    addRecipe() {\n      if (this.selectedFile) {\n        const filePath = `recipes/${new Date().getTime()}_${this.selectedFile.name}`;\n        const fileRef = this.storage.ref(filePath);\n        const uploadTask = this.storage.upload(filePath, this.selectedFile);\n        uploadTask.snapshotChanges().pipe(finalize(() => {\n          fileRef.getDownloadURL().subscribe(url => {\n            this.imageUrl = url;\n            this.saveRecipe();\n          });\n        })).subscribe(() => {}, error => console.error('Error al subir la imagen:', error));\n      } else {\n        this.saveRecipe();\n      }\n    }\n    saveRecipe() {\n      this.auth.user.subscribe(user => {\n        if (user) {\n          const recipe = {\n            titulo: this.titulo,\n            imageUrl: this.imageUrl,\n            descripcion: this.descripcion,\n            categoria: this.categoria,\n            ingredientes: this.ingredientes,\n            // Ahora es un array de objetos `Ingredient`\n            creadorId: user.uid\n          };\n          this.recipeService.addRecipe(recipe).then(() => {}).catch(error => {\n            console.error('Error al agregar la receta:', error);\n          });\n        }\n      });\n    }\n    onFileSelected(event) {\n      var _event$target$files;\n      const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n      if (file) {\n        this.selectedFile = file;\n        const reader = new FileReader();\n        reader.onload = () => {\n          this.imagePreview = reader.result;\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n  }\n  _AddRecipeComponent = AddRecipeComponent;\n  _AddRecipeComponent.ɵfac = function AddRecipeComponent_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _AddRecipeComponent)(i0.ɵɵdirectiveInject(i1.RecipeService), i0.ɵɵdirectiveInject(i2.InventoryService), i0.ɵɵdirectiveInject(i3.AngularFireAuth), i0.ɵɵdirectiveInject(i4.AngularFireStorage));\n  };\n  _AddRecipeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _AddRecipeComponent,\n    selectors: [[\"app-add-recipe\"]],\n    decls: 57,\n    vars: 9,\n    consts: [[\"slot\", \"start\"], [\"position\", \"stacked\"], [3, \"ngModelChange\", \"ngModel\"], [\"type\", \"file\", \"accept\", \"image/*\", 3, \"change\"], [4, \"ngIf\"], [\"value\", \"desayuno\"], [\"value\", \"almuerzo\"], [\"value\", \"cena\"], [\"value\", \"postre\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"number\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"gramos\"], [\"value\", \"ml\"], [\"value\", \"unidad\"], [3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [\"expand\", \"full\", 3, \"click\"], [\"alt\", \"Vista previa de la imagen\", 2, \"width\", \"100%\", \"max-height\", \"200px\", 3, \"src\"], [3, \"value\"]],\n    template: function AddRecipeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n        i0.ɵɵelement(3, \"ion-menu-button\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"Agregar Receta\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"ion-content\")(7, \"ion-list\")(8, \"ion-item\")(9, \"ion-label\", 1);\n        i0.ɵɵtext(10, \"T\\u00EDtulo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"ion-input\", 2);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_input_ngModelChange_11_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.titulo, $event) || (ctx.titulo = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"ion-item\")(13, \"input\", 3);\n        i0.ɵɵlistener(\"change\", function AddRecipeComponent_Template_input_change_13_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(14, AddRecipeComponent_ion_item_14_Template, 2, 1, \"ion-item\", 4);\n        i0.ɵɵelementStart(15, \"ion-item\")(16, \"ion-label\", 1);\n        i0.ɵɵtext(17, \"Descripci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"ion-textarea\", 2);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_textarea_ngModelChange_18_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.descripcion, $event) || (ctx.descripcion = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"ion-item\")(20, \"ion-label\");\n        i0.ɵɵtext(21, \"Categor\\u00EDa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"ion-select\", 2);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_select_ngModelChange_22_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.categoria, $event) || (ctx.categoria = $event);\n          return $event;\n        });\n        i0.ɵɵelementStart(23, \"ion-select-option\", 5);\n        i0.ɵɵtext(24, \"Desayuno\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"ion-select-option\", 6);\n        i0.ɵɵtext(26, \"Almuerzo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"ion-select-option\", 7);\n        i0.ɵɵtext(28, \"Cena\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"ion-select-option\", 8);\n        i0.ɵɵtext(30, \"Postre\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(31, \"ion-item\")(32, \"ion-label\");\n        i0.ɵɵtext(33, \"Seleccionar Ingrediente\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"ion-select\", 2);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_select_ngModelChange_34_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.ingrediente, $event) || (ctx.ingrediente = $event);\n          return $event;\n        });\n        i0.ɵɵtemplate(35, AddRecipeComponent_ion_select_option_35_Template, 2, 2, \"ion-select-option\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"ion-item\")(37, \"ion-label\", 1);\n        i0.ɵɵtext(38, \"Cantidad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"ion-input\", 10);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_input_ngModelChange_39_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.cantidadIngrediente, $event) || (ctx.cantidadIngrediente = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(40, \"ion-item\")(41, \"ion-label\");\n        i0.ɵɵtext(42, \"Unidad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"ion-select\", 2);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_select_ngModelChange_43_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.unidadIngrediente, $event) || (ctx.unidadIngrediente = $event);\n          return $event;\n        });\n        i0.ɵɵelementStart(44, \"ion-select-option\", 11);\n        i0.ɵɵtext(45, \"Gramos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"ion-select-option\", 12);\n        i0.ɵɵtext(47, \"ml\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"ion-select-option\", 13);\n        i0.ɵɵtext(49, \"Unidad\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(50, \"ion-item\")(51, \"ion-button\", 14);\n        i0.ɵɵlistener(\"click\", function AddRecipeComponent_Template_ion_button_click_51_listener() {\n          return ctx.addIngredient();\n        });\n        i0.ɵɵtext(52, \"A\\u00F1adir Ingrediente\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(53, \"ion-list\");\n        i0.ɵɵtemplate(54, AddRecipeComponent_ion_item_54_Template, 2, 3, \"ion-item\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"ion-button\", 16);\n        i0.ɵɵlistener(\"click\", function AddRecipeComponent_Template_ion_button_click_55_listener() {\n          return ctx.addRecipe();\n        });\n        i0.ɵɵtext(56, \"Agregar Receta\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.titulo);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.imagePreview);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.descripcion);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.categoria);\n        i0.ɵɵadvance(12);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.ingrediente);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngForOf\", ctx.globalItems);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.cantidadIngrediente);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.unidadIngrediente);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.ingredientes);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.IonButton, i6.IonButtons, i6.IonContent, i6.IonHeader, i6.IonInput, i6.IonItem, i6.IonLabel, i6.IonList, i6.IonMenuButton, i6.IonSelect, i6.IonSelectOption, i6.IonTextarea, i6.IonTitle, i6.IonToolbar, i6.NumericValueAccessor, i6.SelectValueAccessor, i6.TextValueAccessor, i7.NgControlStatus, i7.NgModel]\n  });\n  return AddRecipeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}