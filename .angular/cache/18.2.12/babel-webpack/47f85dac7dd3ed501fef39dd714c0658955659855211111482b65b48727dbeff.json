{"ast":null,"code":"import { finalize } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/recipe.service\";\nimport * as i2 from \"../../services/inventory.service\";\nimport * as i3 from \"@angular/fire/compat/auth\";\nimport * as i4 from \"@angular/fire/compat/storage\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@ionic/angular\";\nimport * as i7 from \"@angular/forms\";\nfunction AddRecipeComponent_ion_item_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 29);\n    i0.ɵɵelement(1, \"img\", 30);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"src\", ctx_r0.imagePreview, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction AddRecipeComponent_ion_select_option_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-select-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", item_r2.nombre);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(item_r2.nombre);\n  }\n}\nfunction AddRecipeComponent_ion_item_60_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 32)(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ing_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\" \", ing_r3.nombre, \" - \", ing_r3.cantidad, \" \", ing_r3.unidad, \" \");\n  }\n}\nexport let AddRecipeComponent = /*#__PURE__*/(() => {\n  var _AddRecipeComponent;\n  class AddRecipeComponent {\n    constructor(recipeService, inventoryService, auth, storage) {\n      this.recipeService = recipeService;\n      this.inventoryService = inventoryService;\n      this.auth = auth;\n      this.storage = storage;\n      this.titulo = '';\n      this.imageUrl = null;\n      this.descripcion = '';\n      this.categoria = 'desayuno';\n      this.ingredientes = []; // Cambiado de string[] a Ingredient[]\n      this.ingrediente = '';\n      this.cantidadIngrediente = 1;\n      this.unidadIngrediente = 'unidad'; // Nueva propiedad\n      this.selectedFile = null;\n      this.imagePreview = null;\n      this.globalItems = [];\n    }\n    ngOnInit() {\n      this.loadGlobalItems();\n    }\n    loadGlobalItems() {\n      this.inventoryService.getGlobalItems().subscribe(items => {\n        this.globalItems = items;\n      });\n    }\n    addIngredient() {\n      if (this.ingrediente.trim()) {\n        const nuevoIngrediente = {\n          nombre: this.ingrediente.trim(),\n          cantidad: this.cantidadIngrediente,\n          unidad: this.unidadIngrediente\n        };\n        this.ingredientes.push(nuevoIngrediente);\n        this.ingrediente = '';\n        this.cantidadIngrediente = 1;\n        this.unidadIngrediente = 'unidad';\n      }\n    }\n    addRecipe() {\n      if (this.selectedFile) {\n        const filePath = `recipes/${new Date().getTime()}_${this.selectedFile.name}`;\n        const fileRef = this.storage.ref(filePath);\n        const uploadTask = this.storage.upload(filePath, this.selectedFile);\n        uploadTask.snapshotChanges().pipe(finalize(() => {\n          fileRef.getDownloadURL().subscribe(url => {\n            this.imageUrl = url;\n            this.saveRecipe();\n          });\n        })).subscribe(() => {}, error => console.error('Error al subir la imagen:', error));\n      } else {\n        this.saveRecipe();\n      }\n    }\n    saveRecipe() {\n      this.auth.user.subscribe(user => {\n        if (user) {\n          const recipe = {\n            titulo: this.titulo,\n            imageUrl: this.imageUrl,\n            descripcion: this.descripcion,\n            categoria: this.categoria,\n            ingredientes: this.ingredientes,\n            // Ahora es un array de objetos `Ingredient`\n            creadorId: user.uid\n          };\n          this.recipeService.addRecipe(recipe).then(() => {}).catch(error => {\n            console.error('Error al agregar la receta:', error);\n          });\n        }\n      });\n    }\n    onFileSelected(event) {\n      var _event$target$files;\n      const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n      if (file) {\n        this.selectedFile = file;\n        const reader = new FileReader();\n        reader.onload = () => {\n          this.imagePreview = reader.result;\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n  }\n  _AddRecipeComponent = AddRecipeComponent;\n  _AddRecipeComponent.ɵfac = function AddRecipeComponent_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _AddRecipeComponent)(i0.ɵɵdirectiveInject(i1.RecipeService), i0.ɵɵdirectiveInject(i2.InventoryService), i0.ɵɵdirectiveInject(i3.AngularFireAuth), i0.ɵɵdirectiveInject(i4.AngularFireStorage));\n  };\n  _AddRecipeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _AddRecipeComponent,\n    selectors: [[\"app-add-recipe\"]],\n    decls: 64,\n    vars: 9,\n    consts: [[\"slot\", \"start\"], [2, \"padding\", \"1rem\"], [\"lines\", \"full\"], [\"position\", \"stacked\", 2, \"font-weight\", \"bold\"], [\"placeholder\", \"Ejemplo: Ensalada C\\u00E9sar\", 3, \"ngModelChange\", \"ngModel\"], [\"lines\", \"none\"], [\"position\", \"stacked\", 2, \"font-weight\", \"bold\", \"margin-bottom\", \"0.5rem\"], [\"type\", \"file\", \"accept\", \"image/*\", 2, \"width\", \"100%\", \"padding\", \"0.5rem\", 3, \"change\"], [\"lines\", \"none\", \"style\", \"text-align: center;\", 4, \"ngIf\"], [\"placeholder\", \"Ejemplo: Deliciosa ensalada con aderezo casero\", \"auto-grow\", \"\", 3, \"ngModelChange\", \"ngModel\"], [2, \"font-weight\", \"bold\"], [\"placeholder\", \"Seleccionar categor\\u00EDa\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"desayuno\"], [\"value\", \"almuerzo\"], [\"value\", \"cena\"], [\"value\", \"postre\"], [\"placeholder\", \"Seleccionar ingrediente\", 3, \"ngModelChange\", \"ngModel\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"number\", \"placeholder\", \"Ejemplo: 100\", 3, \"ngModelChange\", \"ngModel\"], [\"placeholder\", \"Seleccionar unidad\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"gramos\"], [\"value\", \"ml\"], [\"value\", \"unidad\"], [\"value\", \"onzas\"], [\"value\", \"tazas\"], [\"lines\", \"none\", 2, \"justify-content\", \"center\"], [\"expand\", \"block\", \"color\", \"primary\", 2, \"margin\", \"1rem 0\", 3, \"click\"], [\"lines\", \"none\", \"style\", \"font-size: 0.9rem;\", 4, \"ngFor\", \"ngForOf\"], [\"expand\", \"block\", \"color\", \"success\", 2, \"margin-top\", \"1rem\", 3, \"click\"], [\"lines\", \"none\", 2, \"text-align\", \"center\"], [\"alt\", \"Vista previa de la imagen\", 2, \"width\", \"100%\", \"max-height\", \"200px\", \"border-radius\", \"8px\", \"margin-top\", \"1rem\", 3, \"src\"], [3, \"value\"], [\"lines\", \"none\", 2, \"font-size\", \"0.9rem\"]],\n    template: function AddRecipeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n        i0.ɵɵelement(3, \"ion-menu-button\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\");\n        i0.ɵɵtext(5, \"Agregar Receta\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(6, \"ion-content\")(7, \"ion-list\", 1)(8, \"ion-item\", 2)(9, \"ion-label\", 3);\n        i0.ɵɵtext(10, \"T\\u00EDtulo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"ion-input\", 4);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_input_ngModelChange_11_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.titulo, $event) || (ctx.titulo = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"ion-item\", 5)(13, \"ion-label\", 6);\n        i0.ɵɵtext(14, \"Subir Imagen\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"input\", 7);\n        i0.ɵɵlistener(\"change\", function AddRecipeComponent_Template_input_change_15_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(16, AddRecipeComponent_ion_item_16_Template, 2, 1, \"ion-item\", 8);\n        i0.ɵɵelementStart(17, \"ion-item\", 2)(18, \"ion-label\", 3);\n        i0.ɵɵtext(19, \"Descripci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"ion-textarea\", 9);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_textarea_ngModelChange_20_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.descripcion, $event) || (ctx.descripcion = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(21, \"ion-item\", 2)(22, \"ion-label\", 10);\n        i0.ɵɵtext(23, \"Categor\\u00EDa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"ion-select\", 11);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_select_ngModelChange_24_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.categoria, $event) || (ctx.categoria = $event);\n          return $event;\n        });\n        i0.ɵɵelementStart(25, \"ion-select-option\", 12);\n        i0.ɵɵtext(26, \"Desayuno\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"ion-select-option\", 13);\n        i0.ɵɵtext(28, \"Almuerzo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"ion-select-option\", 14);\n        i0.ɵɵtext(30, \"Cena\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"ion-select-option\", 15);\n        i0.ɵɵtext(32, \"Postre\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(33, \"ion-item\", 2)(34, \"ion-label\", 10);\n        i0.ɵɵtext(35, \"Seleccionar Ingrediente\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"ion-select\", 16);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_select_ngModelChange_36_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.ingrediente, $event) || (ctx.ingrediente = $event);\n          return $event;\n        });\n        i0.ɵɵtemplate(37, AddRecipeComponent_ion_select_option_37_Template, 2, 2, \"ion-select-option\", 17);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(38, \"ion-item\", 2)(39, \"ion-label\", 3);\n        i0.ɵɵtext(40, \"Cantidad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"ion-input\", 18);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_input_ngModelChange_41_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.cantidadIngrediente, $event) || (ctx.cantidadIngrediente = $event);\n          return $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(42, \"ion-item\", 2)(43, \"ion-label\", 10);\n        i0.ɵɵtext(44, \"Unidad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"ion-select\", 19);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function AddRecipeComponent_Template_ion_select_ngModelChange_45_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.unidadIngrediente, $event) || (ctx.unidadIngrediente = $event);\n          return $event;\n        });\n        i0.ɵɵelementStart(46, \"ion-select-option\", 20);\n        i0.ɵɵtext(47, \"Gramos\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"ion-select-option\", 21);\n        i0.ɵɵtext(49, \"ml\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"ion-select-option\", 22);\n        i0.ɵɵtext(51, \"Unidad\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(52, \"ion-select-option\", 23);\n        i0.ɵɵtext(53, \"onzas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(54, \"ion-select-option\", 24);\n        i0.ɵɵtext(55, \"tazas\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(56, \"ion-item\", 25)(57, \"ion-button\", 26);\n        i0.ɵɵlistener(\"click\", function AddRecipeComponent_Template_ion_button_click_57_listener() {\n          return ctx.addIngredient();\n        });\n        i0.ɵɵtext(58, \"A\\u00F1adir Ingrediente\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(59, \"ion-list\");\n        i0.ɵɵtemplate(60, AddRecipeComponent_ion_item_60_Template, 3, 3, \"ion-item\", 27);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(61, \"ion-item\", 25)(62, \"ion-button\", 28);\n        i0.ɵɵlistener(\"click\", function AddRecipeComponent_Template_ion_button_click_62_listener() {\n          return ctx.addRecipe();\n        });\n        i0.ɵɵtext(63, \"Agregar Receta\");\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.titulo);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.imagePreview);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.descripcion);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.categoria);\n        i0.ɵɵadvance(12);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.ingrediente);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngForOf\", ctx.globalItems);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.cantidadIngrediente);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.unidadIngrediente);\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngForOf\", ctx.ingredientes);\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i6.IonButton, i6.IonButtons, i6.IonContent, i6.IonHeader, i6.IonInput, i6.IonItem, i6.IonLabel, i6.IonList, i6.IonMenuButton, i6.IonSelect, i6.IonSelectOption, i6.IonTextarea, i6.IonTitle, i6.IonToolbar, i6.NumericValueAccessor, i6.SelectValueAccessor, i6.TextValueAccessor, i7.NgControlStatus, i7.NgModel]\n  });\n  return AddRecipeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}