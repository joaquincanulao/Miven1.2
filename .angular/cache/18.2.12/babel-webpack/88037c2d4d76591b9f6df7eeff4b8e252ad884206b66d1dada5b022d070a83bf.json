{"ast":null,"code":"import _asyncToGenerator from \"/home/jcanulao/Documentos/Miven1.0.0-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _InventoryComponent;\nimport { SortMenuComponent } from '../sort-menu/sort-menu.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/inventory.service\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/forms\";\nfunction InventoryComponent_div_9_ion_card_1_ion_item_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\")(2, \"h3\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r1.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Venci\\u00F3 el: \", item_r1.fechaVencimiento, \"\");\n  }\n}\nfunction InventoryComponent_div_9_ion_card_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 9)(1, \"ion-card-header\")(2, \"ion-card-title\");\n    i0.ɵɵtext(3, \"Productos Vencidos\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ion-card-content\")(5, \"ion-list\");\n    i0.ɵɵtemplate(6, InventoryComponent_div_9_ion_card_1_ion_item_6_Template, 6, 2, \"ion-item\", 4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.expiredItems);\n  }\n}\nfunction InventoryComponent_div_9_ion_card_2_ion_item_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\")(2, \"h3\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r3.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Vence el: \", item_r3.fechaVencimiento, \"\");\n  }\n}\nfunction InventoryComponent_div_9_ion_card_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 10)(1, \"ion-card-header\")(2, \"ion-card-title\");\n    i0.ɵɵtext(3, \"Productos por Vencer\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ion-card-content\")(5, \"ion-list\");\n    i0.ɵɵtemplate(6, InventoryComponent_div_9_ion_card_2_ion_item_6_Template, 6, 2, \"ion-item\", 4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.expiringSoonItems);\n  }\n}\nfunction InventoryComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, InventoryComponent_div_9_ion_card_1_Template, 7, 1, \"ion-card\", 7)(2, InventoryComponent_div_9_ion_card_2_Template, 7, 1, \"ion-card\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.expiredItems.length > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.expiringSoonItems.length > 0);\n  }\n}\nfunction InventoryComponent_ion_item_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\")(2, \"h2\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"ion-button\", 1);\n    i0.ɵɵlistener(\"click\", function InventoryComponent_ion_item_11_Template_ion_button_click_8_listener() {\n      const item_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.startEditItem(item_r5));\n    });\n    i0.ɵɵtext(9, \"Editar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"ion-button\", 11);\n    i0.ɵɵlistener(\"click\", function InventoryComponent_ion_item_11_Template_ion_button_click_10_listener() {\n      const item_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.deleteItem(item_r5.id));\n    });\n    i0.ɵɵtext(11, \"Eliminar\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r5 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r5.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"Cantidad: \", item_r5.cantidad, \" \", item_r5.unidadMedida, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fecha de Vencimiento: \", item_r5.fechaVencimiento, \"\");\n  }\n}\nfunction InventoryComponent_ng_template_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n    i0.ɵɵtext(3, \"Editar Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-buttons\", 12)(5, \"ion-button\", 1);\n    i0.ɵɵlistener(\"click\", function InventoryComponent_ng_template_13_Template_ion_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.closeEditModal());\n    });\n    i0.ɵɵtext(6, \"Cerrar\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(7, \"ion-content\")(8, \"ion-item\")(9, \"ion-label\", 13);\n    i0.ɵɵtext(10, \"Nueva Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-input\", 14);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function InventoryComponent_ng_template_13_Template_ion_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.editItemCantidad, $event) || (ctx_r1.editItemCantidad = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"ion-button\", 15);\n    i0.ɵɵlistener(\"click\", function InventoryComponent_ng_template_13_Template_ion_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.updateItemQuantity());\n    });\n    i0.ɵɵtext(13, \"Guardar Cambios\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.editItemCantidad);\n  }\n}\nexport class InventoryComponent {\n  constructor(inventoryService, auth, popoverController, alertController) {\n    this.inventoryService = inventoryService;\n    this.auth = auth;\n    this.popoverController = popoverController;\n    this.alertController = alertController;\n    this.inventoryItems = [];\n    this.sortedInventory = [];\n    this.expiredItems = [];\n    this.expiringSoonItems = [];\n    this.userId = null;\n    this.editItemCantidad = null;\n    this.editItemId = null;\n    this.isEditModalOpen = false;\n  }\n  ngOnInit() {\n    this.auth.user.subscribe(user => {\n      if (user) {\n        this.userId = user.uid;\n        this.loadInventory();\n      }\n    });\n    this.requestNotificationPermission();\n  }\n  // Método para cargar el inventario del usuario\n  loadInventory() {\n    if (this.userId) {\n      this.inventoryService.getInventory(this.userId).subscribe(items => {\n        this.inventoryItems = items;\n        this.sortInventory('alphabetical');\n        this.checkExpiringItems();\n      });\n    }\n  }\n  openSortMenu(ev) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const popover = yield _this.popoverController.create({\n        component: SortMenuComponent,\n        event: ev,\n        translucent: true\n      });\n      yield popover.present();\n      const {\n        data\n      } = yield popover.onDidDismiss();\n      if (data) {\n        _this.sortInventory(data);\n      }\n    })();\n  }\n  // Método para ordenar el inventario...\n  sortInventory(type) {\n    if (type === 'alphabetical') {\n      this.sortedInventory = [...this.inventoryItems].sort((a, b) => a.nombre.localeCompare(b.nombre));\n    } else if (type === 'expiration') {\n      this.sortedInventory = [...this.inventoryItems].sort((a, b) => {\n        return new Date(a.fechaVencimiento).getTime() - new Date(b.fechaVencimiento).getTime();\n      });\n    }\n  }\n  // Solicitar permiso de notificación al usuario:3\n  requestNotificationPermission() {\n    if ('Notification' in window) {\n      Notification.requestPermission().then(permission => {\n        if (permission === 'granted') {\n          console.log('Permiso para notificaciones otorgado');\n        } else {\n          console.log('Notificaciones bloqueadas');\n        }\n      });\n    }\n  }\n  // Enviar notificación para ítems próximos a vencer...\n  sendNotification(itemName, expirationDate) {\n    if ('Notification' in window && Notification.permission === 'granted') {\n      new Notification('Producto por vencer', {\n        body: `El ítem ${itemName} vence el ${expirationDate}.`,\n        icon: 'assets/icon/alert.png' // Cambia por el ícono que prefieras\n      });\n    }\n  }\n  // Método para eliminar un ítem del inventario\n  deleteItem(itemId) {\n    if (this.userId && confirm('¿Estás seguro de que deseas eliminar este ítem del inventario?')) {\n      this.inventoryService.deleteItemFromInventory(itemId, this.userId).then(() => {\n        console.log('Ítem eliminado con éxito');\n        this.loadInventory();\n      }).catch(error => {\n        console.error('Error al eliminar el ítem:', error);\n      });\n    }\n  }\n  startEditItem(item) {\n    this.editItemCantidad = item.cantidad;\n    this.editItemId = item.id;\n    this.isEditModalOpen = true;\n  }\n  closeEditModal() {\n    this.isEditModalOpen = false;\n    this.editItemCantidad = null;\n    this.editItemId = null;\n  }\n  updateItemQuantity() {\n    if (this.userId && this.editItemId && this.editItemCantidad != null) {\n      this.inventoryService.updateItemQuantity(this.userId, this.editItemId, this.editItemCantidad).then(() => {\n        console.log('Cantidad actualizada con éxito');\n        this.closeEditModal(); // Cerrar el modal después de la actualización\n      }).catch(error => {\n        console.error('Error al actualizar la cantidad:', error);\n      });\n    }\n  }\n  convertDate(fecha) {\n    if (fecha instanceof Date) {\n      return fecha; // Si ya es un objeto Date, regresarlo directamente\n    }\n    if (typeof fecha === 'string') {\n      const parts = fecha.split('-');\n      if (parts.length === 3) {\n        // Convertir de Dias, meses y años a años, meses y días.\n        const [day, month, year] = parts.map(part => parseInt(part, 10));\n        return new Date(year, month - 1, day);\n      }\n    }\n    console.error('Formato de fecha inválido:', fecha);\n    return new Date(NaN); // Retornar fecha inválida si no coincide el formato\n  }\n  // Verificar productos vencidos y por vencer\n  checkExpiringItems() {\n    const today = new Date();\n    const oneWeekFromNow = new Date();\n    oneWeekFromNow.setDate(today.getDate() + 7);\n    console.log('Hoy es:', today);\n    console.log('Una semana desde hoy es:', oneWeekFromNow);\n    this.expiredItems = this.inventoryItems.filter(item => {\n      const expiryDate = this.convertDate(item.fechaVencimiento);\n      if (isNaN(expiryDate.getTime())) {\n        console.warn(`Fecha inválida para el ítem ${item.nombre}:`, item.fechaVencimiento);\n        return false;\n      }\n      return expiryDate < today; // Productos ya vencidos\n    });\n    this.expiringSoonItems = this.inventoryItems.filter(item => {\n      const expiryDate = this.convertDate(item.fechaVencimiento);\n      if (isNaN(expiryDate.getTime())) {\n        console.warn(`Fecha inválida para el ítem ${item.nombre}:`, item.fechaVencimiento);\n        return false;\n      }\n      return expiryDate >= today && expiryDate <= oneWeekFromNow; // Por vencer en 7 días\n    });\n    console.log('Productos vencidos:', this.expiredItems);\n    console.log('Productos por vencer:', this.expiringSoonItems);\n    this.showAlerts();\n  }\n  // Mostrar alertas para productos vencidos y por vencer\n  showAlerts() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (_this2.expiredItems.length > 0) {\n        const alert = yield _this2.alertController.create({\n          header: 'Productos Vencidos',\n          message: `Tienes ${_this2.expiredItems.length} producto(s) vencido(s):${_this2.expiredItems.map(item => item.nombre).join(', ')}`,\n          buttons: ['OK']\n        });\n        yield alert.present();\n      }\n      if (_this2.expiringSoonItems.length > 0) {\n        const alert = yield _this2.alertController.create({\n          header: 'Productos por Vencer',\n          message: `Tienes ${_this2.expiringSoonItems.length} producto(s) que vencerán pronto:<br>${_this2.expiringSoonItems.map(item => item.nombre).join(', ')}`,\n          buttons: ['OK']\n        });\n        yield alert.present();\n      }\n    })();\n  }\n  processItems(expiredItems, expiringItems) {\n    console.log(\"Expired Items:\", expiredItems);\n    console.log(\"Expiring Items:\", expiringItems);\n  }\n}\n_InventoryComponent = InventoryComponent;\n_InventoryComponent.ɵfac = function InventoryComponent_Factory(__ngFactoryType__) {\n  return new (__ngFactoryType__ || _InventoryComponent)(i0.ɵɵdirectiveInject(i1.InventoryService), i0.ɵɵdirectiveInject(i2.AngularFireAuth), i0.ɵɵdirectiveInject(i3.PopoverController), i0.ɵɵdirectiveInject(i3.AlertController));\n};\n_InventoryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _InventoryComponent,\n  selectors: [[\"app-inventory\"]],\n  decls: 16,\n  vars: 3,\n  consts: [[\"slot\", \"start\"], [3, \"click\"], [\"name\", \"funnel\", \"slot\", \"icon-only\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"isOpen\"], [\"expand\", \"full\", \"routerLink\", \"/add-item\"], [\"color\", \"danger\", 4, \"ngIf\"], [\"color\", \"warning\", 4, \"ngIf\"], [\"color\", \"danger\"], [\"color\", \"warning\"], [\"color\", \"danger\", 3, \"click\"], [\"slot\", \"end\"], [\"position\", \"floating\"], [\"type\", \"number\", 3, \"ngModelChange\", \"ngModel\"], [\"expand\", \"full\", 3, \"click\"]],\n  template: function InventoryComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n      i0.ɵɵelement(3, \"ion-menu-button\");\n      i0.ɵɵelementStart(4, \"ion-title\");\n      i0.ɵɵtext(5, \"Inventario\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"ion-button\", 1);\n      i0.ɵɵlistener(\"click\", function InventoryComponent_Template_ion_button_click_6_listener($event) {\n        return ctx.openSortMenu($event);\n      });\n      i0.ɵɵelement(7, \"ion-icon\", 2);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(8, \"ion-content\");\n      i0.ɵɵtemplate(9, InventoryComponent_div_9_Template, 3, 2, \"div\", 3);\n      i0.ɵɵelementStart(10, \"ion-list\");\n      i0.ɵɵtemplate(11, InventoryComponent_ion_item_11_Template, 12, 4, \"ion-item\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"ion-modal\", 5);\n      i0.ɵɵtemplate(13, InventoryComponent_ng_template_13_Template, 14, 1, \"ng-template\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"ion-button\", 6);\n      i0.ɵɵtext(15, \"Agregar \\u00CDtem\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngIf\", ctx.expiredItems.length > 0 || ctx.expiringSoonItems.length > 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.sortedInventory);\n      i0.ɵɵadvance();\n      i0.ɵɵproperty(\"isOpen\", ctx.isEditModalOpen);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i3.IonButton, i3.IonButtons, i3.IonCard, i3.IonCardContent, i3.IonCardHeader, i3.IonCardTitle, i3.IonContent, i3.IonHeader, i3.IonIcon, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonList, i3.IonMenuButton, i3.IonTitle, i3.IonToolbar, i3.IonModal, i3.NumericValueAccessor, i3.RouterLinkDelegate, i5.RouterLink, i6.NgControlStatus, i6.NgModel],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["SortMenuComponent","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate","item_r1","nombre","ɵɵtextInterpolate1","fechaVencimiento","ɵɵtemplate","InventoryComponent_div_9_ion_card_1_ion_item_6_Template","ɵɵproperty","ctx_r1","expiredItems","item_r3","InventoryComponent_div_9_ion_card_2_ion_item_6_Template","expiringSoonItems","InventoryComponent_div_9_ion_card_1_Template","InventoryComponent_div_9_ion_card_2_Template","length","ɵɵlistener","InventoryComponent_ion_item_11_Template_ion_button_click_8_listener","item_r5","ɵɵrestoreView","_r4","$implicit","ɵɵnextContext","ɵɵresetView","startEditItem","InventoryComponent_ion_item_11_Template_ion_button_click_10_listener","deleteItem","id","ɵɵtextInterpolate2","cantidad","unidadMedida","InventoryComponent_ng_template_13_Template_ion_button_click_5_listener","_r6","closeEditModal","ɵɵtwoWayListener","InventoryComponent_ng_template_13_Template_ion_input_ngModelChange_11_listener","$event","ɵɵtwoWayBindingSet","editItemCantidad","InventoryComponent_ng_template_13_Template_ion_button_click_12_listener","updateItemQuantity","ɵɵtwoWayProperty","InventoryComponent","constructor","inventoryService","auth","popoverController","alertController","inventoryItems","sortedInventory","userId","editItemId","isEditModalOpen","ngOnInit","user","subscribe","uid","loadInventory","requestNotificationPermission","getInventory","items","sortInventory","checkExpiringItems","openSortMenu","ev","_this","_asyncToGenerator","popover","create","component","event","translucent","present","data","onDidDismiss","type","sort","a","b","localeCompare","Date","getTime","window","Notification","requestPermission","then","permission","console","log","sendNotification","itemName","expirationDate","body","icon","itemId","confirm","deleteItemFromInventory","catch","error","item","convertDate","fecha","parts","split","day","month","year","map","part","parseInt","NaN","today","oneWeekFromNow","setDate","getDate","filter","expiryDate","isNaN","warn","showAlerts","_this2","alert","header","message","join","buttons","processItems","expiringItems","ɵɵdirectiveInject","i1","InventoryService","i2","AngularFireAuth","i3","PopoverController","AlertController","selectors","decls","vars","consts","template","InventoryComponent_Template","rf","ctx","ɵɵelement","InventoryComponent_Template_ion_button_click_6_listener","InventoryComponent_div_9_Template","InventoryComponent_ion_item_11_Template","InventoryComponent_ng_template_13_Template"],"sources":["/home/jcanulao/Documentos/Miven1.0.0-main/src/app/inventory/inventory.component.ts","/home/jcanulao/Documentos/Miven1.0.0-main/src/app/inventory/inventory.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { InventoryService } from '../services/inventory.service';\nimport { AngularFireAuth } from '@angular/fire/compat/auth';\nimport { PopoverController } from '@ionic/angular';\nimport { SortMenuComponent } from '../sort-menu/sort-menu.component';\nimport { AlertController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-inventory',\n  templateUrl: './inventory.component.html',\n  styleUrls: ['./inventory.component.scss']\n})\nexport class InventoryComponent implements OnInit {\n  inventoryItems: any[] = [];\n  sortedInventory: any[] = [];\n  expiredItems: any[] = [];\n  expiringSoonItems: any[] = [];\n  userId: string | null = null;\n  editItemCantidad: number | null = null;\n  editItemId: string | null = null;\n  isEditModalOpen = false;\n\n\n  constructor(private inventoryService: InventoryService, \n              private auth: AngularFireAuth,\n              private popoverController: PopoverController,\n              private alertController: AlertController\n            ) {}\n\n  ngOnInit(): void {\n    this.auth.user.subscribe(user => {\n      if (user) {\n        this.userId = user.uid;\n        this.loadInventory();\n        }\n    });\n\n    this.requestNotificationPermission(); \n  }\n\n  // Método para cargar el inventario del usuario\n  loadInventory() {\n    if (this.userId) {\n      this.inventoryService.getInventory(this.userId).subscribe(items => {\n        this.inventoryItems = items;\n        this.sortInventory('alphabetical');\n        this.checkExpiringItems();\n        });\n    }\n  }\n\n  \n  async openSortMenu(ev: any) {\n    const popover = await this.popoverController.create({\n      component: SortMenuComponent,\n      event: ev,\n      translucent: true\n    });\n\n    await popover.present();\n\n    const { data } = await popover.onDidDismiss();\n    if (data) {\n      this.sortInventory(data);\n    }\n  }\n\n  // Método para ordenar el inventario...\n  sortInventory(type: string) {\n    if (type === 'alphabetical') {\n      this.sortedInventory = [...this.inventoryItems].sort((a, b) => a.nombre.localeCompare(b.nombre));\n    } else if (type === 'expiration') {\n      this.sortedInventory = [...this.inventoryItems].sort((a, b) => {\n        return new Date(a.fechaVencimiento).getTime() - new Date(b.fechaVencimiento).getTime();\n      });\n    }\n  }\n\n\n  // Solicitar permiso de notificación al usuario:3\n  requestNotificationPermission() {\n    if ('Notification' in window) {\n      Notification.requestPermission().then(permission => {\n        if (permission === 'granted') {\n          console.log('Permiso para notificaciones otorgado');\n        } else {\n          console.log('Notificaciones bloqueadas');\n        }\n      });\n    }\n  }\n\n  // Enviar notificación para ítems próximos a vencer...\n  sendNotification(itemName: string, expirationDate: string) {\n    if ('Notification' in window && Notification.permission === 'granted') {\n      new Notification('Producto por vencer', {\n        body: `El ítem ${itemName} vence el ${expirationDate}.`,\n        icon: 'assets/icon/alert.png' // Cambia por el ícono que prefieras\n      });\n    }\n  }\n\n  // Método para eliminar un ítem del inventario\n  deleteItem(itemId: string) {\n    if (this.userId && confirm('¿Estás seguro de que deseas eliminar este ítem del inventario?')) {\n      this.inventoryService.deleteItemFromInventory(itemId, this.userId).then(() => {\n        console.log('Ítem eliminado con éxito');\n        this.loadInventory();\n      }).catch(error => {\n        console.error('Error al eliminar el ítem:', error);\n      });\n    }\n  }\n\n startEditItem(item: any) {\n  this.editItemCantidad = item.cantidad;\n  this.editItemId = item.id;\n  this.isEditModalOpen = true;\n}\n\ncloseEditModal() {\n  this.isEditModalOpen = false;\n  this.editItemCantidad = null;\n  this.editItemId = null;\n}\n\nupdateItemQuantity() {\n  if (this.userId && this.editItemId && this.editItemCantidad != null) {\n    this.inventoryService.updateItemQuantity(this.userId, this.editItemId, this.editItemCantidad).then(() => {\n      console.log('Cantidad actualizada con éxito');\n      this.closeEditModal();  // Cerrar el modal después de la actualización\n    }).catch(error => {\n      console.error('Error al actualizar la cantidad:', error);\n    });\n  }\n}\n\nconvertDate(fecha: string | Date): Date {\n  if (fecha instanceof Date) {\n    return fecha; // Si ya es un objeto Date, regresarlo directamente\n  }\n\n  if (typeof fecha === 'string') {\n    const parts = fecha.split('-');\n    if (parts.length === 3) {\n      // Convertir de Dias, meses y años a años, meses y días.\n      const [day, month, year] = parts.map(part => parseInt(part, 10));\n      return new Date(year, month - 1, day);\n    }\n  }\n\n  console.error('Formato de fecha inválido:', fecha);\n  return new Date(NaN); // Retornar fecha inválida si no coincide el formato\n}\n\n\n// Verificar productos vencidos y por vencer\ncheckExpiringItems() {\n  const today = new Date();\n  const oneWeekFromNow = new Date();\n  oneWeekFromNow.setDate(today.getDate() + 7);\n\n  console.log('Hoy es:', today);\n  console.log('Una semana desde hoy es:', oneWeekFromNow);\n\n  this.expiredItems = this.inventoryItems.filter(item => {\n    const expiryDate = this.convertDate(item.fechaVencimiento);\n\n    if (isNaN(expiryDate.getTime())) {\n      console.warn(`Fecha inválida para el ítem ${item.nombre}:`, item.fechaVencimiento);\n      return false;\n    }\n\n    return expiryDate < today; // Productos ya vencidos\n  });\n\n  this.expiringSoonItems = this.inventoryItems.filter(item => {\n    const expiryDate = this.convertDate(item.fechaVencimiento);\n\n    if (isNaN(expiryDate.getTime())) {\n      console.warn(`Fecha inválida para el ítem ${item.nombre}:`, item.fechaVencimiento);\n      return false;\n    }\n\n    return expiryDate >= today && expiryDate <= oneWeekFromNow; // Por vencer en 7 días\n  });\n\n  console.log('Productos vencidos:', this.expiredItems);\n  console.log('Productos por vencer:', this.expiringSoonItems);\n\n  this.showAlerts();\n}\n\n// Mostrar alertas para productos vencidos y por vencer\nasync showAlerts() {\n  if (this.expiredItems.length > 0) {\n    const alert = await this.alertController.create({\n      header: 'Productos Vencidos',\n      message: `Tienes ${this.expiredItems.length} producto(s) vencido(s):${this.expiredItems.map(item => item.nombre).join(', ')}`,\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n\n  if (this.expiringSoonItems.length > 0) {\n    const alert = await this.alertController.create({\n      header: 'Productos por Vencer',\n      message: `Tienes ${this.expiringSoonItems.length} producto(s) que vencerán pronto:<br>${this.expiringSoonItems.map(item => item.nombre).join(', ')}`,\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n}\nprocessItems(expiredItems: string[], expiringItems: string[]): void {\n  console.log(\"Expired Items:\", expiredItems);\n  console.log(\"Expiring Items:\", expiringItems);\n}\n}","<ion-header>\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-menu-button></ion-menu-button>\n      <ion-title>Inventario</ion-title>\n      <ion-button (click)=\"openSortMenu($event)\">\n        <ion-icon name=\"funnel\" slot=\"icon-only\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <!-- Sección de alertas -->\n  <div *ngIf=\"expiredItems.length > 0 || expiringSoonItems.length > 0\">\n    <!-- Alertas de productos vencidos -->\n    <ion-card *ngIf=\"expiredItems.length > 0\" color=\"danger\">\n      <ion-card-header>\n        <ion-card-title>Productos Vencidos</ion-card-title>\n      </ion-card-header>\n      <ion-card-content>\n        <ion-list>\n          <ion-item *ngFor=\"let item of expiredItems\">\n            <ion-label>\n              <h3>{{ item.nombre }}</h3>\n              <p>Venció el: {{ item.fechaVencimiento }}</p>\n            </ion-label>\n          </ion-item>\n        </ion-list>\n      </ion-card-content>\n    </ion-card>\n\n    <!-- Alertas de productos por vencer -->\n    <ion-card *ngIf=\"expiringSoonItems.length > 0\" color=\"warning\">\n      <ion-card-header>\n        <ion-card-title>Productos por Vencer</ion-card-title>\n      </ion-card-header>\n      <ion-card-content>\n        <ion-list>\n          <ion-item *ngFor=\"let item of expiringSoonItems\">\n            <ion-label>\n              <h3>{{ item.nombre }}</h3>\n              <p>Vence el: {{ item.fechaVencimiento }}</p>\n            </ion-label>\n          </ion-item>\n        </ion-list>\n      </ion-card-content>\n    </ion-card>\n  </div>\n\n  <!-- Lista de ítems del inventario -->\n  <ion-list>\n    <ion-item *ngFor=\"let item of sortedInventory\">\n      <ion-label>\n        <h2>{{ item.nombre }}</h2>\n        <p>Cantidad: {{ item.cantidad }} {{ item.unidadMedida }}</p>\n        <p>Fecha de Vencimiento: {{ item.fechaVencimiento }}</p>\n      </ion-label>\n      <ion-button (click)=\"startEditItem(item)\">Editar</ion-button>\n      <ion-button color=\"danger\" (click)=\"deleteItem(item.id)\">Eliminar</ion-button>\n    </ion-item>\n  </ion-list>\n\n  <!-- Modal para editar la cantidad -->\n  <ion-modal [isOpen]=\"isEditModalOpen\">\n    <ng-template>\n      <ion-header>\n        <ion-toolbar>\n          <ion-title>Editar Cantidad</ion-title>\n          <ion-buttons slot=\"end\">\n            <ion-button (click)=\"closeEditModal()\">Cerrar</ion-button>\n          </ion-buttons>\n        </ion-toolbar>\n      </ion-header>\n      <ion-content>\n        <ion-item>\n          <ion-label position=\"floating\">Nueva Cantidad</ion-label>\n          <ion-input type=\"number\" [(ngModel)]=\"editItemCantidad\"></ion-input>\n        </ion-item>\n        <ion-button expand=\"full\" (click)=\"updateItemQuantity()\">Guardar Cambios</ion-button>\n      </ion-content>\n    </ng-template>\n  </ion-modal>\n\n  <!-- Botón para agregar un ítem -->\n  <ion-button expand=\"full\" routerLink=\"/add-item\">Agregar Ítem</ion-button>\n</ion-content> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}