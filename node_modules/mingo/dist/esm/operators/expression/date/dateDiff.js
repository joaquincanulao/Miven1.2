import { computeValue } from "../../../core";
<<<<<<< HEAD
import { computeDate, DURATION_IN_MILLIS } from "./_internal";
const $dateDiff = (obj, expr, options) => {
  const args = computeValue(obj, expr, null, options);
  const d1 = computeDate(obj, expr.startDate, options);
  const d2 = computeDate(obj, expr.endDate, options);
  let diff;
  switch (args.unit) {
    case "year":
    case "quarter":
    case "month":
      diff = diffYQM(d1, d2, args.unit);
      break;
    default:
      diff = (d2.getTime() - d1.getTime()) / DURATION_IN_MILLIS[args.unit];
  }
  return diff;
};
const unitMonths = {
  year: 12,
  quarter: 3,
  month: 1
};
function diffYQM(d1, d2, unit) {
  let months = (d2.getUTCFullYear() - d1.getUTCFullYear()) * 12;
  months -= d1.getUTCMonth();
  months += d2.getUTCMonth();
  return Math.trunc(months / unitMonths[unit]);
}
=======
import {
  adjustDate,
  dateDiffDay,
  dateDiffHour,
  dateDiffMonth,
  dateDiffQuarter,
  dateDiffWeek,
  dateDiffYear,
  parseTimezone,
  TIMEUNIT_IN_MILLIS
} from "./_internal";
const $dateDiff = (obj, expr, options) => {
  const { startDate, endDate, unit, timezone, startOfWeek } = computeValue(
    obj,
    expr,
    null,
    options
  );
  const d1 = new Date(startDate);
  const d2 = new Date(endDate);
  const minuteOffset = parseTimezone(timezone);
  adjustDate(d1, minuteOffset);
  adjustDate(d2, minuteOffset);
  switch (unit) {
    case "year":
      return dateDiffYear(d1, d2);
    case "quarter":
      return dateDiffQuarter(d1, d2);
    case "month":
      return dateDiffMonth(d1, d2);
    case "week":
      return dateDiffWeek(d1, d2, startOfWeek);
    case "day":
      return dateDiffDay(d1, d2);
    case "hour":
      return dateDiffHour(d1, d2);
    case "minute":
      d1.setUTCSeconds(0);
      d1.setUTCMilliseconds(0);
      d2.setUTCSeconds(0);
      d2.setUTCMilliseconds(0);
      return Math.round(
        (d2.getTime() - d1.getTime()) / TIMEUNIT_IN_MILLIS[unit]
      );
    default:
      return Math.round(
        (d2.getTime() - d1.getTime()) / TIMEUNIT_IN_MILLIS[unit]
      );
  }
};
>>>>>>> 7cb31df57 (se integro la edicion de las recetas)
export {
  $dateDiff
};
