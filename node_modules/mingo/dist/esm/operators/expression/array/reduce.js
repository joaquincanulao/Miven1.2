import {
  ComputeOptions,
  computeValue
} from "../../../core";
import { assert, isArray, isNil } from "../../../util";
const $reduce = (obj, expr, options) => {
  const copts = ComputeOptions.init(options);
  const input = computeValue(obj, expr.input, null, copts);
  const initialValue = computeValue(obj, expr.initialValue, null, copts);
  const inExpr = expr["in"];
<<<<<<< HEAD
<<<<<<< HEAD
  if (isNil(input))
    return null;
=======
  if (isNil(input)) return null;
>>>>>>> 7cb31df57 (se integro la edicion de las recetas)
=======
  if (isNil(input)) return null;
>>>>>>> cfa17b8e4 (favorite)
  assert(isArray(input), "$reduce 'input' expression must resolve to an array");
  return input.reduce((acc, n) => {
    return computeValue(
      n,
      inExpr,
      null,
      copts.update(copts.root, {
        variables: { value: acc }
      })
    );
  }, initialValue);
};
export {
  $reduce
};
